<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Football Viewer</title>
  <style>
    html,body { margin:0; padding:0; height:100%; background:#000; overflow:hidden; }
    video { width:100%; height:100%; object-fit:cover; }

    /* Floating scoreboard */
    #scoreboard {
      position:absolute;
      bottom:20px; left:50%;
      transform:translateX(-50%);
      color:#fff;
      font-family:Arial, Helvetica, sans-serif;
      font-size:18px;
      padding:10px 20px;
      display:flex; justify-content:space-between; align-items:center;
      border-radius:10px;
      box-shadow:0 4px 15px rgba(0,0,0,0.6);
      min-width:70%;
      max-width:85%;
    }
    .team {
      display:flex; align-items:center; gap:10px;
      font-weight:bold;
    }
    .team-name { text-transform:uppercase; font-size:20px; }
    .score {
      font-size:26px; font-weight:bold;
      background:rgba(0,0,0,0.6);
      padding:4px 12px; border-radius:6px;
    }
    .center { text-align:center; flex-grow:1; font-size:18px; font-weight:bold; }

    /* Flag overlay */
    #flag {
      position:absolute;
      bottom:100px;
      left:50%; transform:translateX(-50%);
      background:yellow; color:black;
      font-size:28px; font-weight:600;
      font-family:Arial, Helvetica, sans-serif;
      padding:12px 40px;
      border-radius:8px;
      opacity:0; max-height:0; overflow:hidden;
      transition:all 0.5s ease-in-out;
      box-shadow:0 3px 10px rgba(0,0,0,0.5);
      white-space:nowrap;
    }
    #flag.show { opacity:1; max-height:120px; }
  </style>
</head>
<body>
  <video id="remoteVideo" autoplay playsinline muted></video>
  <div id="flag">FLAG ON THE PLAY</div>

  <div id="scoreboard">
    <div class="team">
      <span id="homeName" class="team-name">HOME</span>
      <span class="score" id="homeScore">0</span>
    </div>
    <div class="center">
      Q<span id="quarter">1</span> | <span id="clock">15:00</span>
    </div>
    <div class="team">
      <span id="awayName" class="team-name">AWAY</span>
      <span class="score" id="awayScore">0</span>
    </div>
  </div>

<script>
  const channel = new BroadcastChannel("football-game");

  channel.onmessage = e => {
    const s = e.data;
    document.getElementById("homeName").textContent = s.home;
    document.getElementById("awayName").textContent = s.away;
    document.getElementById("homeScore").textContent = s.score.home;
    document.getElementById("awayScore").textContent = s.score.away;
    document.getElementById("quarter").textContent = s.quarter;
    document.getElementById("clock").textContent = formatClock(s.clock);

    // Gradient background from home â†’ away color
    document.getElementById("scoreboard").style.background =
      `linear-gradient(90deg, ${s.homeColor}, ${s.awayColor})`;

    if(s.flag) showFlag();
  };

  function formatClock(sec){
    const m=Math.floor(sec/60).toString().padStart(2,"0");
    const s=(sec%60).toString().padStart(2,"0");
    return `${m}:${s}`;
  }

  function showFlag(){
    const f=document.getElementById("flag");
    f.classList.add("show");
    setTimeout(()=>f.classList.remove("show"),7000);
  }

  // Demo only: viewer shows its own webcam
  navigator.mediaDevices.getUserMedia({video:true,audio:false})
    .then(stream => { document.getElementById("remoteVideo").srcObject = stream; });
</script>
</body>
</html>
